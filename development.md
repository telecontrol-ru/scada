---
layout: default
permalink: /development
---

# Проектирование

{:.no_toc}

* TOC
{:toc}

Для редактирования проекта используется Графический клиент. Следует выполнить вход систему с реквизитами пользователя, обладающим административными правами. При этом меню Клиента будет дополнено административными командами.

### Общие команды

<dl>

<dt>Параметры (только для администратора)</dt>
Отображает окно параметров выделенного объекта.

<dt>Элементы (только для администратора)</dt>
<dd>Отображает таблицу параметров всех элементов, входящих в выделенный объект (группу или направление).</dd>

<dt>Удалить (только для администратора)</dt>
<dd>Удаляет выделенный объект или устройство из системы.</dd>

</dl>

## Конфигурирование пользователей

Окно пользователей может быть вызвано вызовом команды главного меню *Далее - Пользователи*.

![](img/users.jpg)

Двойной щелчок в строке пользователя позволяет начать редактирование имени пользователя или парв доступа.

Возможные права доступа:

* 0 - оператор
* 3 - администриратор

Для создания нового пользователя выберите команду *Создать - Пользователь* из контекстного меню окна.

Для удаления пользователя выберите команду *Удалить* из контекстного меню пользователя.

Для смены пароля выберите команду *Задать пароль* из контекстного меню пользователя.

## Конфигурирование оборудования

### Создание устройств

Добавить направление МЭК-60870-5 можно выбрав из контекстного меню подсистемы МЭК пункт *Создать - Направление МЭК-101* или *Создать Направление МЭК-104*.

Добавить устройство МЭК-60870-5 можно из контекстного меню направления, выбрав пункт *Создать - Устройство*.

### Параметры устройств

Для редактирования параметров элемента следует из контекстного меню элемента выбрать пункт *Параметры*.

### Устройства MODBUS

#### Параметры направления MODBUS

<dl>

<dt>Задержка запроса</dt>
<dd>Искусственная задержка (в миллисекундах) между ответом и запросом следующего блока данных. Используется для устройств с замедленным переключением режима приема-передачи серийного порта.</dd>

</dl>

#### Параметры устройства MODBUS

<dl>

<dt>Число повторов при неответе</dt>
<dd>Максимальное число повторных запросов при отсутствии ответа устройства. По истечении числа повторов будет зарегистрирована потеря связи с устройством.</dd>

<dt>Таймаут ответа</dt>
<dd>Максимальное время ожидания ответа устройства, спустя которое будет выполнен повторный запрос. По истечении числа повторов будет зарегистрирована потеря связи с устройством.</dd>

</dl>

#### Каналы MODBUS

В протоколе MODBUS используется четрые группы объектов:

| Тип       | Команда   | Доступ        |
|:----------|:----------|:--------------|
| COIL      | 0x01/0x05 | Чтение/запись |
| DISCINPUT | 0x02      | Чтение        |
| INPUTREG  | 0x04      | Чтение        |
| HOLDREG   | 0x03/0x06 | Чтение/запись |

Адреса MODBUS могут быть преобразованы в следующие типы данных (со знаком/без знака):

* BOOL
* INT8/UINT8
* INT16/UINT16
* INT32/UINT32
* FLOAT
* DOUBLE

Полный формат адреса канала:

`<тип>:<тип данных>:<адрес>`

В целях обратной совместимости используется адрес +1.

#### Краткий формат адреса канала MODBUS

Допустим формат адреса без явного указания типа объекта:

`<тип данных>:<адрес>`

При этом используется следующее соответствие типов объектов и диапазонов адресов:

* 0...10000: COILS (0x01/0x05)
* 10000...20000: DISCINPUT (0x02)
* 30000...40000: INPUTREG (0x04)
* 40000...50000: HOLDREG (0x03/0x06)

#### Примеры каналов MODBUS

* `HOLDREG:FLOAT:10465`
Чтение двух Modbus регистров 10464 и 10465 командой 0х03 в формате FLOAT.

* `INPUTREG:FLOAT:10465`
Чтение двух Modbus регистров 10464 и 10465 командой 0х04 в формате FLOAT.

* `HOLDREG:INT32:10001`
Чтение двух Modbus регистров 10000 и 10001 командой 0х03 в формате целое 32 бит со знаком.

* `INPUTREG:UINT32:10001`
Чтение двух Modbus регистров 10000 и 10001 командой 0х03 в формате целое 32 бит без знака.

* `HOLDREG:DOUBLE:10001`
Чтение четырех Modbus регистров 10000 - 10003 командой 0х03 в формате DOUBLE.

* `1`
Чтение/запись Modbus выхода 0 командами 0x01/0x05 в формате BOOL.

* `10001`
Чтение Modbus входа 0 командой 0x02 в формате BOOL.

* `30001`
Чтение Modbus регистра 0 командой 0х04 в формате INT16 со знаком.

* `40001`
Чтение Modbus регистра 0 командой 0х03 в формате INT16 со знаком.

* `BOOL:30001`
Чтение Modbus регистра 0 командой 0х04 в формате BOOL 16 бит.

### Устройства МЭК-60870-5

#### Параметры направления МЭК-60870-5

<dl>

<dt>Отправка до квитанции</dt>
<dd>Определяет максимальное количество отправляемых ASDU до получения квитации.</dd>

<dt>Прием до квитанции</dt>
<dd>Определяет количество принятых ASDU, после которых отправляется квитация.</dd>

</dl>

Стандартые размеры полей:

| Параметр         | 104 | 101 |
|:-----------------|:---:|:---:|
| Адрес устройства | 2   | 1   |
| Причина передачи | 2   | 1   |
| Адрес объекта    | 3   | 2   |

#### Параметры устройства МЭК-60870-5

<dl>

<dt>Адрес</dt>
<dd>Определяет адрес устройства в кадре ASDU.</dd>

<dt>Синхронизация часов</dt>
<dd>При установке флага Сервер будет отправлять команду синхронизации часов. При этом, если Период равен 0, команда будет отправлена единожды; в ином случае будет выполняться периодическая синхронизация.</dd>

<dt>Период опроса</dt>
<dd>Группа определяет периоды отправки команды полного опроса (General Interrogation) и период опроса каждой группы МЭК отдельно. Описание групп смотрите в стандарте МЭК для команды полного опроса. Значение периода задается в секундах. При указании значения 0 полный опрос будет выполнен один раз после установлении соединения. Если флаг *Период опроса* выключен, опрос производиться не будет.</dd>

<dt>Таймауты выполнения процессов</dt>
<dd>Таймауты выполнения команд, выдаваемых устройству: телеуправление, полный опрос.</dd>

</dl>

### Устройства МЭК-61850

Смотрите [отображение модели МЭК-61850](architecture#iec-61850) и описание архитектуры [подсистемы МЭК-61850](architecture#iec-61850).

Выбором Параметры из контекстного меню любого объекта поддерева Модели можно посмотреть адрес объекта МЭК-61850 для привязки к объектам сервера.

Создать привязанные объекты сервера также можно перетягиванием объектов из Модели в произвольную группу Панели объектов. Перетягиванием группы FC МЭК-61850 можно создать все объекты этой группы. Перетягивание объекта информационной модели на существующий объект сервера обновляет привязку объекта.

## Конфигурирование исторических баз данных

## Конфигурирование объектов данных

### Создание объектов

### Удаление объектов

### Копирование объектов

### Перетягивание объектов

### Параметры объектов

<dl>

<dt>Имя объекта</dt>
<dd>Отображается в любом месте системы, где есть упоминание об этом объекте. Имя может состоять из произвольных символов, уникальность не требуется. Для точной идентификации объекта в местах отображения используется полный формат имени, включающий в себя имена всех родительских групп, например: "Группа 1 : Подгруппа 1 : ТС1".</dd>

<dt>Алиас</dt>
<dd>Задает уникальное имя объекта в системе. Может использоваться для быстрого ввода объекта в таблицы и графики, а также для привязки объектов к элементам мнемосхемы. В других случаях алиас можно не указывать. Допустимы алиасы, состоящие из английских и русских букв и цифр, но не содержащие пробелов. Длина алиаса не должна превышать 50 символов.</dd>

<dt>Источник данных</dt>
<dd>Позволяет выбрать Основной или Резервный источник данных. А также перейти в режим Управления.</dd>

<dt>Режим управления</dt>
<dd>Задается, если нужно телеуправление объектом.</dd>

<dt>Устройство</dt>
<dd>Позволяет выбрать устройство, являющееся источником данных. Либо, если устройство не выбрано, в строке элемент задается дорасчет.</dd>

<dt>Элемент</dt>
<dd>Здесь указывается либо адрес информационного объекта устройства, либо выбирается параметр из списка. Если устройство не выбрано, здесь же вводится выражение дорасчета.</dd>

<dt>Инверсия</dt>
<dd>Определяет, следует ли инвертировать полученное с устройства состояние ТС.</dd>

<dt>Формат</dt>
<dd>Позволяет указать способ отображения объекта ТС на экране, выбрав один из существующих форматов. Просмотреть и изменить список форматов можно выбрав из главного меню Далее – Форматы.</dd>

<dt>Преобразование и диапазоны</dt>
<dd>Содержит параметры, определяющие правила обработки входящих данных для объектов ТИТ.
  <dl>

  <dt>Линейное</dt>
  <dd>Используется линейное преобразование шкалы (смещение и масштабирование).</dd>

  <dt>Нет</dt>
  <dd>Позволяет отключить преобразование входных данных.</dd>

  </dl>
</dd>

<dt>Лог мин и Лог макс</dt>
<dd>Определяют логический диапазон значений объекта ТИТ. Используются для любого типа преобразования. Определяют шкалу графиков.</dd>

<dt>Физ мин и Физ макс</dt>
<dd>Используются для линейного преобразования и определяют физический диапазон значений получаемых с устройства.</dd>

<dt>Ограничение диапазона</dt>
<dd>Ограничивает значение пределами логического диапазона.</dd>

<dt>Контроль устаревания</dt>
<dd>Позволяет задать время устаревания событий.</dd>

<dt>Архивирование</dt>
<dd>Задает глубину хранения архивных данных для объекта.</dd>

<dt>Параметры</dt>
<dd>Определяет форматирование значения объекта ТИТ при отображении
  <dl>

  <dt>Формат</dt>
  <dd>Определяет количество знаков после запятой.</dd>

  <dt>Ед. изм.</dt>
  <dd>Определяет единицу измерения ("Вт", "А"), выводимую после значения.</dd>

  </dl>
</dd>

<dt>Эмуляция</dt>
<dd>Позволяет включить эмуляцию сигнала. Тип эмуляции можно выбрать в выпадающем списке. Редактирование списка доступно из вкладки *Далее – Эмулируемые сигналы*.</dd>

</dl>

## Таблица параметров

Табличный режим редактирования параметров объектов призван упростить работу со множеством объектов. В этом режиме объекты расположены в строказ таблицы, а их различные параметры отображаются в столбцах.

Доступно тиражирование ячеек растягиванием выделения за нижний правый угол, аналогично Excel. Если содержимое ячейки оканчивается числом, оно будет изменяться автоматически. При растягивании вниз число будет увеличиваться, при растягивании вверх - уменьшаться. Чтобы отключить автоматическое изменение ячейки зажмите *Ctrl*.

Из контекстного меню таблицы доступны операции *Копирования* и *Вставки* объектов.

## Электронные схемы ActiveXeme

Мнемосхемы (файлы с расширением sde) располагаются в папке *%ProgramData%\Telecontrol\SCADA Client* на каждом рабочем месте.

При добавлении новой схемы, она будет доступна из меню Схемы после перезапуска Клиента. Также, папку схем можно открыть из Клиента командой меню *Настройки - Открыть папку схем MODUS*.

При изменения схемы или алиаса достаточно закрыть и повторно открыть схему в ОИК для применения изменений.

### Привязка объектов

Для привязки объекта ТС или ТИТ к мнемосхеме нужно задать алиас объекта. Это можно сделать в окне параметров Клиента, открываемом при выборе пункта Параметры из контекстного меню объекта. Допустимы алиасы, состоящие из английских и русских букв и цифр, но не содержащие пробелов.

После того, как алиас будет определен, его нужно привязать к элементу схемы. Объекты ТС привязываются к переключателям, имеющим свойство *положение*, а ТИТ - к текстовым полям со свойством *текст*. В Графическом редакторе выберите элемент и укажите алиас как значение для свойства *ключ_привязки* в редакторе свойств (F11).

Для привязки произвольного свойства, используйте выражение вида *имя_свойства=алиас*. Для привязки нескольких свойств одного объекта используйте разделитель точку с запятой: *имя_свойства1=алиас1;имя_свойства2=алиас2*.

### Заголовок схемы

Заголовок схемы записывается в файле sde. Он может быть изменен при помощи Графического редактора Модус, вызовом команды меню *Файл - Свойства* и заданием атрибута *Тема*.

До первого вызова схемы в Клиенте в списке меню *Схемы* будет отображаться имя ее файла. После того, как заголовок схемы, сохраненный в файле sde, будет кеширован, он будет отображаться вместо имени файла. Кроме того, будут проиндексированы все имеющиеся на схеме привязки для быстрого перехода на схему при выполнении команды [*Схема*](client/display#goto-object).

## [](#excel-cfg)Редактирование конфигурации в Excel

## Серверные файлы

Вместо копирования файлов схем на каждый клиент удобнее хранить схемы в центральном месте на сервере. Файлы хранятся в папке `%ProgramData%\Telecontrol\SCADA Server\FileSystem` на серверном компьютере. Оттуда они раздаются всем клиентам. Достаточно изменить схему в одном месте, чтобы она обновилась у всех.

Редактировать файлы на сервере можно с клиента, через контекстное меню корневого узла "Файлы". Также, в панели файлов файлы можно организовать по папкам.
